install.packages("devtools")
library('devtools')
install_github(repo='swirl', username = 'ncarchedi')
libary('swirl')
library('swirl')
swirl()
setwd("~/Zipfian/week5/government-shutdown")
source('~/Zipfian/week5/government-shutdown/boilerplate.r')
source('~/Zipfian/week5/government-shutdown/exploration.R')
withdrawals <-t2[(t2$transaction_type == 'withdrawal') & (t2$is_net == 1),]
withdrawals$date <- as.Date(withdrawals$date)
withdrawals$greatest = factor(withdrawals$item, levels = names(sort(table(withdrawals$item), decreasing = TRUE)[1:10]))
#with_great_freq <- withdrawals[withdrawals$item%in%withdrawals$greatest]
p1 <- ggplot(withdrawals)
p1 <- p1 + aes(x = date, y = today, group = greatest, color = greatest) + geom_point(na.rm = TRUE)
p1 + scale_y_log10()
t2$date <- as.date(t2$date)
t2$date <- as.Date(t2$date)
withdrawals <-t2[(t2$transaction_type == 'withdrawal') & (t2$is_net == 0) & (t2$today > 0),]
withdrawals$date <- as.Date(withdrawals$date)
withdrawals$greatest = factor(withdrawals$item, levels = names(sort(table(withdrawals$item), decreasing = TRUE)[1:10]))
#with_great_freq <- withdrawals[withdrawals$item%in%withdrawals$greatest]
p1 <- ggplot(withdrawals)
p1 <- p1 + aes(x = date, y = today, group = greatest, color = greatest) + geom_point(na.rm = TRUE)
p1 + scale_y_log10()
p1 + scale_y_log10(breaks = c(10,1000,100000,10000000))
summary(withdrawals$today)
p1 + scale_y_log10(labels = dollars))
p1 + scale_y_log10(labels = dollars)
p1 + scale_y_log10(labels = dollar)
install.packages(scales)
install.packages('scales')
install.packages("scales")
install.packages("scales")
install.packages("scales")
install.packages("scales")
install.packages("scales")
install.packages("scales")
install.packages("scales")
source('~/Zipfian/week5/government-shutdown/boilerplate.r')
library(scale)
library(scales)
p1 + scale_y_log10(labels = dollar)
t2$date <- as.Date(t2$date)
withdrawals <-t2[(t2$transaction_type == 'withdrawal') & (t2$is_net == 0) & (t2$today > 0),]
withdrawals$date <- as.Date(withdrawals$date)
withdrawals$greatest = factor(withdrawals$item, levels = names(sort(table(withdrawals$item), decreasing = TRUE)[1:10]))
#with_great_freq <- withdrawals[withdrawals$item%in%withdrawals$greatest]
p1 <- ggplot(withdrawals)
p1 <- p1 + aes(x = date, y = today, group = greatest, color = greatest) + geom_point(na.rm = TRUE)
p1 + scale_y_log10(labels = dollar)
?aggregate
t2$date <- as.Date(t2$date)
withdrawals <-t2[(t2$transaction_type == 'withdrawal') & (t2$is_net == 0) &
(t2$date > as.Date('2013-10-1') & (t2$today > 0),]
withdrawals$date <- as.Date(withdrawals$date)
withdrawals$greatest = factor(withdrawals$item, levels = names(sort(table(withdrawals$item), decreasing = TRUE)[1:10]))
#with_great_freq <- withdrawals[withdrawals$item%in%withdrawals$greatest]
p1 <- ggplot(withdrawals)
p1 <- p1 + aes(x = date, y = today, group = greatest, color = greatest) + geom_point(na.rm = TRUE)
p1 + scale_y_log10(labels = dollar)
View(withdrawals)
t2$date <- as.Date(t2$date)
withdrawals <-t2[(t2$transaction_type == 'withdrawal') & (t2$is_net == 0) &
(t2$date > as.Date('2013-10-1') & (t2$today > 0),]
withdrawals <-t2[(t2$transaction_type == 'withdrawal') & (t2$is_net == 0) &
(t2$date > as.Date('2013-10-1')) & (t2$today > 0),]
withdrawals$greatest = factor(withdrawals$item, levels = names(sort(table(withdrawals$item), decreasing = TRUE)[1:10]))
#with_great_freq <- withdrawals[withdrawals$item%in%withdrawals$greatest]
p1 <- ggplot(withdrawals)
p1 <- p1 + aes(x = date, y = today, group = greatest, color = greatest) + geom_point(na.rm = TRUE)
p1 + scale_y_log10(labels = dollar)
withdrawals <-t2[(t2$transaction_type == 'withdrawal') & (t2$is_net == 0) &
(t2$date > as.Date('2013-10-1')),]
levels = names(sort(table(withdrawals$item), decreasing = TRUE)[1:10])
levels
withdrawl['item'%in%levels,]
withdrawl['item'%in%levels,]
withdrawAl['item'%in%levels,]
withdrawal['item'%in%levels,]
withdrawals['item'%in%levels,]
mask = withdrawls['item'%in%levels]
mask = withdrawals['item'%in%levels]
mask
makse[,]
maks[,]
mask[,]
mask = withdrawals[,'item'%in%levels]
mask
mask = withdrawals['item'%in%levels,]
mask
withdrawals[withdrawals['item',]%in%levels,]
withdrawals[withdrawals[,'item']%in%levels,]
new = withdrawals[withdrawals[,'item']%in%levels,]
new
str(new)
str(new)
new$item
t2$date <- as.Date(t2$date)
withdrawals <-t2[(t2$transaction_type == 'withdrawal') & (t2$is_net == 0) &
(t2$date > as.Date('2013-10-1')),]
t2$date <- as.Date(t2$date)
withdrawals <-t2[(t2$transaction_type == 'withdrawal') & (t2$is_net == 0) &
(t2$date > as.Date('2013-10-1')),]
new <- withdrawals[withdrawals[,'item']%in%levels,]
t2$date <- as.Date(t2$date)
withdrawals <-t2[(t2$transaction_type == 'withdrawal') & (t2$is_net == 0) &
(t2$date > as.Date('2013-10-1')),]
new <- withdrawals[withdrawals[,'item']%in%levels,]
withdrawals[,'item']%in%levels
t2$date <- as.Date(t2$date)
withdrawals <-t2[(t2$transaction_type == 'withdrawal') & (t2$is_net == 0)]
new <- withdrawals[withdrawals[,'item']%in%levels,]
withdrawals <-t2[(t2$transaction_type == 'withdrawal') & (t2$is_net == 0),]
new <- withdrawals[withdrawals[,'item']%in%levels,]
rm(mask)
t2$date <- as.Date(t2$date)
withdrawals <-t2[(t2$transaction_type == 'withdrawal') & (t2$is_net == 0),]
top = names(sort(table(withdrawals$item), decreasing = TRUE)[1:10])
top_item_wd <- withdrawals[withdrawals[,'item']%in%top,]
#with_great_freq <- withdrawals[withdrawals$item%in%withdrawals$greatest]
p1 <- ggplot(top_item_wd)
p1 <- p1 + aes(x = date, y = today, group = greatest, color = greatest) + geom_point(na.rm = TRUE)
p1 + scale_y_log10(labels = dollar)
View(top_item_wd)
t2$date <- as.Date(t2$date)
withdrawals <-t2[(t2$transaction_type == 'withdrawal') & (t2$is_net == 0) & (t2$date > as.Date('2008-01-01')),]
top = names(sort(table(withdrawals$item), decreasing = TRUE)[1:10])
top_item_wd <- withdrawals[withdrawals[,'item']%in%top,]
str(top_item_wd$item)
t2$date <- as.Date(t2$date)
withdrawals <-t2[(t2$transaction_type == 'withdrawal') & (t2$is_net == 0) & (t2$date > as.Date('2008-01-01')),]
top = names(sort(table(withdrawals$item), decreasing = TRUE)[1:10])
withdrawals$greatest = factor(withdrawals$item, levels = top))
top = names(sort(table(withdrawals$item), decreasing = TRUE)[1:10])
withdrawals$greatest = factor(withdrawals$item, levels = top))
withdrawals$greatest = factor(withdrawals$item, levels = top)
withdrawals <-t2[(t2$transaction_type == 'withdrawal') & (t2$is_net == 0) & (t2$date > as.Date('2008-01-01')),]
top = names(sort(table(withdrawals$item), decreasing = TRUE)[1:10])
withdrawals$greatest = factor(withdrawals$item, levels = top)
top_item_wd <- withdrawals[withdrawals[,'item']%in%top,]
p1 <- ggplot(top_item_wd)
p1 <- p1 + aes(x = date, y = today, group = greatest, color = greatest) + geom_point(na.rm = TRUE)
p1 + scale_y_log10(labels = dollar)
recent_top_item_wd$recent <- sapply(top_item_wd$date, function(x){if (x > as.Date('2013-08-01')) 1 else 0})
top_item_wd$recent <- sapply(top_item_wd$date, function(x){if (x > as.Date('2013-08-01')) 1 else 0})
?aggregate
test <- aggregate(top_item_wd, by = c(top_item_wd$item), FUN = mean)
test <- aggregate(top_item_wd, by = top_item_wd$item, FUN = mean)
?list
test <- aggregate(top_item_wd, by = list(top_item_wd$item), FUN = mean)
warnings()
?aggregate
testDF <- data.frame(v1 = c(1,3,5,7,8,3,5,NA,4,5,7,9),
v2 = c(11,33,55,77,88,33,55,NA,44,55,77,99) )
by1 <- c("red", "blue", 1, 2, NA, "big", 1, 2, "red", 1, NA, 12)
by2 <- c("wet", "dry", 99, 95, NA, "damp", 95, 99, "red", 99, NA, NA)
aggregate(x = testDF, by = list(by1, by2), FUN = "mean")
?group
test <- aggregate(date~item, data = top_item_wd, FUN = mean)
test
test <- aggregate(item~today, data = top_item_wd, FUN = mean)
test
test <- aggregate(today~item, data = top_item_wd, FUN = mean)
test
top_item_wd[top_item_wd[,'recent' == 1]]
top_item_wd[,"recent" == 1]
top_item_wd["recent" == 1,]
top_item_wd["recent" == 1,]
top_item_wd["recent" == 0,]
str(top_item_wd[,'recent'])
top_item_wd[,'recent'] == 1
mask = top_item_wd[,'recent'] == 1
mask
top_item_wd[mask,]
test <- aggregate(today~item, data = top_item_wd[mask,], FUN = mean)
test
recent_mask = top_item_wd[,'recent'] == 1
old_mask = top_item_wd[,'recent'] == 0
str(recent_mask)
str(old_mask)
sum(recent_mask)
sum(old_mask)
recent_agg <- aggregate(today~item, data = top_item_wd[new_mask,], FUN = mean)
old_agg <- aggregate(today~item, data = top_item_wd[old_mask,], FUN = mean)
recent_mask = top_item_wd[,'recent'] == 1
old_mask = top_item_wd[,'recent'] == 0
recent_agg <- aggregate(today~item, data = top_item_wd[recent_mask,], FUN = mean)
old_agg <- aggregate(today~item, data = top_item_wd[old_mask,], FUN = mean)
recent_agg
old_agg
agg = recent_agg + old_agg
?join
??join
merge(recent_agg, old_agg)
merge(recent_agg, old_agg, by.x = item, by.y = item)
merge(recent_agg, old_agg, by.x = 'item'', by.y = 'item')
merge(recent_agg, old_agg, by.x = 'item', by.y = 'item')
?names
test =merge(recent_agg, old_agg, by.x = 'item', by.y = 'item')
names(test) <- c('Expense', 'During Shutdown', 'Pre Shutdown')
names(test)
test
p2 <- p2 + aes(Expense, During Shutdown, Pre Shutdown) + geom_boxplot()
p2 <- p2 + aes(Expense, During Shutdown, Pre Shutdown) + geom_boxplot()
p2 <- p2 + aes(Expense, fill = c(During Shutdown, Pre-Shutdown)) + geom_bar(position = 'dodge')
p2 <- ggplot(top_item_wd)
p2 <- ggplot(merged_agg)
old_agg <- aggregate(today~item, data = top_item_wd[old_mask,], FUN = mean)
merged_agg <- merge(recent_agg, old_agg, by.x = 'item', by.y = 'item')
names(merged_agg) <- c('Expense', 'During Shutdown', 'Pre Shutdown')
p2 <- ggplot(merged_agg)
p2 <- p2 + aes(Expense, fill = c(During Shutdown, Pre-Shutdown)) + geom_bar(position = 'dodge')
p2 <- p2 + aes(Expense) + geom_bar(position = 'dodge')
print p2
print(p2)
p2 <- p2 + aes(Expense) + geom_bar(position = 'dodge', stat = "mean")
print(p2)
p2 <- p2 + aes(Expense) + geom_bar(position = 'dodge', stat = "median")
p2 <- p2 + aes(Expense) + geom_bar(position = 'dodge', stat = "average")
p2 <- p2 + aes(Expense) + geom_bar(position = 'dodge', stat = 'identity')
print(p2)
p2 <- p2 + aes(x = Expense, y = 'During Shutdown')  + geom_bar(position = 'dodge', stat = 'identity')
print(p2)
p2 <- p2 + aes(x = 'Expense', y = 'During Shutdown')  + geom_bar(position = 'dodge', stat = 'identity')
print(p2)
p2 <- p2 + aes(x = Expense, y = During Shutdown)  + geom_bar(position = 'dodge', stat = 'identity')
names(merged_agg) <- c('Expense', 'During-Shutdown', 'Pre-Shutdown')
p2 <- ggplot(merged_agg)
p2 <- p2 + aes(x = Expense, y = During_Shutdown)  + geom_bar(position = 'dodge', stat = 'identity')
p2 <- p2 + aes(x = Expense, y = During-Shutdown)  + geom_bar(position = 'dodge', stat = 'identity')
print(p2)
names(merged_agg) <- c('Expense', 'DuringShutdown', 'PreShutdown')
p2 <- ggplot(merged_agg)
p2 <- p2 + aes(x = Expense, y = During-Shutdown)  + geom_bar(position = 'dodge', stat = 'identity')
print(p2)
p2 <- p2 + aes(x = Expense, y = DuringShutdown)  + geom_bar(position = 'dodge', stat = 'identity')
print(p2)
p2 <- p2 + aes(x = Expense, y = DuringShutdown)  + geom_bar(stat = 'identity') +
geom_bar(data =  merged_agg[,'PreShutdown'], position = 'dodge')
merged
merged_agg
p1 <- ggplot(top_item_wd)
p1 <- p1 + aes(x = date, y = today, group = greatest, color = greatest) + geom_point(na.rm = TRUE)
p1 + scale_y_log10(labels = dollar)
View(`t1_subset`)
View(`t1`)
p2 <- p2 + aes(x = Expense, fill = )  + geom_bar(position = 'dodge',stat = 'identity') +
scale_y_log10()
p2 <- ggplot(merged_agg)
p2 <- p2 + aes(x = Expense, fill = )  + geom_bar(position = 'dodge',stat = 'identity') +
scale_y_log10(labels = dollars)
library(scales)
p2 <- ggplot(merged_agg)
p2 <- p2 + aes(x = Expense, fill = )  + geom_bar(position = 'dodge',stat = 'identity') +
scale_y_log10(labels = dollars)
p2 <- ggplot(merged_agg)
p2 <- p2 + aes(x = Expense, fill = )  + geom_bar(position = 'dodge',stat = 'identity') +
scale_y_log10(labels = dollar)
print(p2)
p2 <- ggplot(merged_agg)
p2 <- p2 + aes(x = Expense)  + geom_bar(position = 'dodge',stat = 'identity') +
scale_y_log10(labels = dollar)
print(p2)
p2 <- p2 + aes(x = Expense, y = c(DuringShutdown, PreShutdown))  + geom_bar(position = 'dodge',stat = 'identity') +
scale_y_log10(labels = dollar)
print(p2)
p2 <- p2 + aes(x = Expense, y = c(DuringShutdown))  + geom_bar(position = 'dodge',stat = 'identity') +
scale_y_log10(labels = dollar)
print(p2)
p2 <- p2 + aes(x = Expense, y = c(DuringShutdown))  + geom_bar(position = 'dodge',stat = 'identity') +
scale_y_log10(labels = dollar), scale_x_discrete(angle = 90)
p2 <- p2 + aes(x = Expense, y = c(DuringShutdown))  + geom_bar(position = 'dodge',stat = 'identity') +
scale_y_log10(labels = dollar) + scale_x_discrete(angle = 90)
recent_agg
Expense = c(recent_agg$item, old_agg$item)
expense
Expense
merged_agg
old_agg
merged = data.frame(Expense = c(recent_agg$item, old_agg$item),
Amount = c(recent_agg$today, old_agg$today))
merged
dim(old_agg)
dim(old_agg)[1]
str(dim(old_agg)[1])
rm(merged)
merged_agg = data.frame(Expense = c(recent_agg$item, old_agg$item),
Amount = c(recent_agg$today, old_agg$today),
recent = c(rep(0,dim(recent_agg)[0]) + rep(1,dim(old_agg)[0])))
dim(recent_agg)[0]
merged_agg = data.frame(Expense = c(recent_agg$item, old_agg$item),
Amount = c(recent_agg$today, old_agg$today),
recent = c(rep(0,dim(recent_agg)[1]) + rep(1,dim(old_agg)[1])))
merged_agg
merged_agg = data.frame(Expense = c(recent_agg$item, old_agg$item),
Amount = c(recent_agg$today, old_agg$today),
recent = c(rep(0,dim(recent_agg)[1]), rep(1,dim(old_agg)[1])))
merged_agg
p2 <- ggplot(merged_agg)
p2 <- p2 + aes(x = Expense, y = Amount)  + geom_bar(position = 'dodge',stat = 'identity') +
scale_y_log10(labels = dollar) + scale_x_discrete(title = "Expense")
p2 <- ggplot(merged_agg)
p2 <- p2 + aes(x = Expense, y = Amount)  + geom_bar(position = 'dodge',stat = 'identity') +
scale_y_log10(labels = dollar) + scale_x_discrete()
print(p2)
p2 <- ggplot(merged_agg)
p2 <- p2 + aes(x = Expense, y = Amount, group = recent, color = recent)  + geom_bar(position = 'dodge',stat = 'identity') +
scale_y_log10(labels = dollar) + scale_x_discrete()
print(p2)
p2 <- ggplot(merged_agg)
p2 <- p2 + aes(x = Expense, y = Amount, group = recent, fill = recent)  + geom_bar(position = 'dodge',stat = 'identity') +
scale_y_log10(labels = dollar) + scale_x_discrete()
print(p2)
p2 <- ggplot(merged_agg)
p2 <- p2 + aes(x = Expense, y = Amount, group = factor(recent), fill = recent)  + geom_bar(position = 'dodge',stat = 'identity') +
scale_y_log10(labels = dollar) + scale_x_discrete()
print(p2)
p2 <- p2 + aes(x = Expense, y = Amount, group = factor(recent), fill = factor(recent))  + geom_bar(position = 'dodge',stat = 'identity') +
scale_y_log10(labels = dollar) + scale_x_discrete()
print(p2)
p2 <- ggplot(merged_agg)
p2 <- p2 + aes(x = Expense, y = Amount, group = factor(recent), fill = factor(recent))  + geom_bar(position = 'dodge',stat = 'identity') +
scale_y_continous(labels = dollar) + scale_x_discrete()
print(p2)
p2 <- ggplot(merged_agg)
p2 <- p2 + aes(x = Expense, y = Amount, group = factor(recent), fill = factor(recent))  + geom_bar(position = 'dodge',stat = 'identity') +
scale_y_continous(labels = dollar) + scale_x_discrete()
print(p2)
p2 <- ggplot(merged_agg)
p2 <- p2 + aes(x = Expense, y = Amount, group = factor(recent), fill = factor(recent))  + geom_bar(position = 'dodge',stat = 'identity') + scale_x_discrete()
print(p2)
p2 <- ggplot(merged_agg)
p2 <- p2 + aes(x = Expense, y = Amount, group = factor(recent), fill = factor(recent))  + geom_bar(position = 'dodge',stat = 'identity') +
scale_y_continous(labels = dollar) + scale_x_discrete()
print(p2)
p2 <- ggplot(merged_agg)
p2 <- p2 + aes(x = Expense, y = Amount, group = factor(recent), fill = factor(recent))  + geom_bar(position = 'dodge',stat = 'identity') +
scale_y_log10(labels = dollar) + scale_x_discrete()
print(p2)
merged_agg = data.frame(Expense = c(recent_agg$item, old_agg$item),
Amount = c(recent_agg$today, old_agg$today),
recent = c(rep('During Showtown',dim(recent_agg)[1]), rep('Pre Shutdown',dim(old_agg)[1])))
p2 <- ggplot(merged_agg)
p2 <- p2 + aes(x = Expense, y = Amount, group = factor(recent), fill = factor(recent))  + geom_bar(position = 'dodge',stat = 'identity') +
scale_y_log10(labels = dollar) + scale_x_discrete()
print(p2)
withdrawals <-t2[(t2$transaction_type == 'withdrawal') & (t2$is_net == 0) & (t2$date > as.Date('2008-01-01')),]
top = names(sort(table(withdrawals$item), decreasing = TRUE)[1:20])
withdrawals$greatest = factor(withdrawals$item, levels = top)
top_item_wd <- withdrawals[withdrawals[,'item']%in%top,]
#with_great_freq <- withdrawals[withdrawals$item%in%withdrawals$greatest]
p1 <- ggplot(top_item_wd)
p1 <- p1 + aes(x = date, y = today, group = greatest, color = greatest) + geom_point(na.rm = TRUE)
p1 + scale_y_log10(labels = dollar)
top_item_wd$recent <- sapply(top_item_wd$date, function(x){if (x > as.Date('2013-08-01')) 1 else 0})
recent_mask = top_item_wd[,'recent'] == 1
old_mask = top_item_wd[,'recent'] == 0
recent_agg <- aggregate(today~item, data = top_item_wd[recent_mask,], FUN = mean)
old_agg <- aggregate(today~item, data = top_item_wd[old_mask,], FUN = mean)
merged_agg = data.frame(Expense = c(recent_agg$item, old_agg$item),
Amount = c(recent_agg$today, old_agg$today),
recent = c(rep('During Showtown',dim(recent_agg)[1]), rep('Pre Shutdown',dim(old_agg)[1])))
p2 <- ggplot(merged_agg)
p2 <- p2 + aes(x = Expense, y = Amount, group = factor(recent), fill = factor(recent))  + geom_bar(position = 'dodge',stat = 'identity') +
scale_y_log10(labels = dollar) + scale_x_discrete()
print(p2)
p2 <- ggplot(merged_agg)
p2 <- p2 + aes(x = Expense, y = Amount, group = factor(recent), fill = factor(recent))  + geom_bar(position = 'dodge',stat = 'identity') +
scale_y_log10(labels = dollar) + labs(title = "Average Goverment Program Withdrawals", legend = '')
print(p2)
ggsave(filename='shutdown_bar.jpg', plot = p2)
ggsave(filename='shutdown_point.jpg', plot = p1)
t2$date <- as.Date(t2$date)
withdrawals <-t2[(t2$transaction_type == 'withdrawal') & (t2$is_net == 0) & (t2$date > as.Date('2008-01-01')),]
top = names(sort(table(withdrawals$item), decreasing = TRUE)[1:20])
withdrawals$greatest = factor(withdrawals$item, levels = top)
top_item_wd <- withdrawals[withdrawals[,'item']%in%top,]
#with_great_freq <- withdrawals[withdrawals$item%in%withdrawals$greatest]
p1 <- ggplot(top_item_wd)
p1 <- p1 + aes(x = date, y = today, group = greatest, color = greatest) + geom_point(na.rm = TRUE)
p1 + scale_y_log10(labels = dollar)
p1 + scale_y_log10(labels = dollar)
p1 <- ggplot(top_item_wd)
p1 <- p1 + aes(x = date, y = today, group = greatest, color = greatest) + geom_point(na.rm = TRUE)
p1 + scale_y_log10(labels = dollar)
withdrawals <-t2[(t2$transaction_type == 'withdrawal') & (t2$is_net == 0) & (t2$date > as.Date('2008-01-01')),]
top = names(sort(table(withdrawals$item), decreasing = TRUE)[1:100])
withdrawals$greatest = factor(withdrawals$item, levels = top)
top_item_wd <- withdrawals[withdrawals[,'item']%in%top,]
top_item_wd$recent <- sapply(top_item_wd$date, function(x){if (x > as.Date('2013-08-01')) 1 else 0})
recent_mask = top_item_wd[,'recent'] == 1
old_mask = top_item_wd[,'recent'] == 0
recent_agg <- aggregate(today~item, data = top_item_wd[recent_mask,], FUN = mean)
old_agg <- aggregate(today~item, data = top_item_wd[old_mask,], FUN = mean)
merged_agg = data.frame(Expense = c(recent_agg$item, old_agg$item),
Amount = c(recent_agg$today, old_agg$today),
recent = c(rep('During Showtown',dim(recent_agg)[1]), rep('Pre Shutdown',dim(old_agg)[1])))
p2 <- ggplot(merged_agg)
p2 <- p2 + aes(x = Expense, y = Amount, group = factor(recent), fill = factor(recent))  + geom_bar(position = 'dodge',stat = 'identity') +
scale_y_log10(labels = dollar) + labs(title = "Average Goverment Program Withdrawals")
print(p2)
